














SELECT SAL
FROM EMP
WHERE ENAME = 'SCOTT';

SELECT ENAME
FROM EMP
WHERE SAL > 3000;

SELECT EMPNO, ENAME, JOB, SAL
FROM EMP
WHERE SAL > (
    SELECT SAL
    FROM EMP
    WHERE ENAME = 'SCOTT'
);

SELECT EMPNO, ENAME, JOB, SAL
FROM EMP
WHERE DEPTNO = (
    SELECT DEPTNO
    FROM EMP
    WHERE ENAME = 'SCOTT'
);

-- SAL ЦђБе < SAL
SELECT ENAME
FROM EMP
WHERE SAL > (
    SELECT AVG(SAL)
    FROM EMP
);

SELECT ENAME
FROM EMP
WHERE SAL < (
    SELECT AVG(SAL)
    FROM EMP
);

SELECT EMPNO, ENAME, JOB, HIREDATE, SAL
FROM EMP
WHERE JOB = (
    SELECT JOB
    FROM EMP
    WHERE EMPNO = 7521
) AND SAL > (
    SELECT SAL
    FROM EMP
    WHERE EMPNO = 7934
);

SELECT *
FROM EMP
WHERE JOB = (
    SELECT JOB
    FROM EMP
    WHERE ENAME = 'SCOTT'
);

SELECT DEPTNO, MIN(SAL)
FROM EMP
GROUP BY DEPTNO
HAVING MIN(SAL) > (
    SELECT MIN(SAL)
    FROM EMP
    WHERE DEPTNO = 20
);

SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE SAL > (
    SELECT SAL
    FROM EMP
    WHERE ENAME = 'BLAKE'
);

SELECT EMPNO, ENAME, HIREDATE
FROM EMP
WHERE HIREDATE > (
    SELECT HIREDATE
    FROM EMP
    WHERE ENAME = 'MILLER'
);

SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE SAL > (
    SELECT AVG(SAL)
    FROM EMP
);

SELECT EMPNO, ENAME, JOB, HIREDATE, SAL, DEPTNO
FROM EMP
WHERE SAL IN (
    SELECT MIN(SAL)
    FROM EMP
    GROUP BY JOB
);

SELECT SAL
FROM EMP
WHERE JOB = 'MANAGER';

SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE SAL < ALL (
    SELECT SAL
    FROM EMP
    WHERE JOB = 'MANAGER'
);

SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE SAL > ANY (
    SELECT SAL
    FROM EMP
    WHERE JOB = 'MANAGER'
);

SELECT *
FROM EMP
WHERE EXISTS (
    SELECT EMPNO
    FROM EMP
    WHERE COMM IS NOT NULL
);

SELECT DEPTNO, EMPNO, ENAME, SAL
FROM EMP
WHERE (DEPTNO, SAL) IN (
    SELECT DEPTNO, MAX(SAL)
    FROM EMP
    GROUP BY DEPTNO
);

SELECT DEPTNO, EMPNO, ENAME, SAL
FROM EMP
WHERE DEPTNO IN (
    SELECT DEPTNO
    FROM EMP
    GROUP BY DEPTNO
) AND SAL IN (
    SELECT MAX(SAL)
    FROM EMP
    GROUP BY DEPTNO
);

SELECT e.DEPTNO, TOTAL_SUM, TOTAL_AVG, CNT
FROM (
    SELECT DEPTNO, SUM(SAL) TOTAL_SUM,
        AVG(SAL) TOTAL_AVG, COUNT(*) CNT
    FROM EMP
    GROUP BY DEPTNO
) e, DEPT d
WHERE e.DEPTNO = d.DEPTNO;

SELECT DEPTNO, SUM(SAL), AVG(SAL), COUNT(*)
FROM EMP
NATURAL JOIN DEPT
GROUP BY DEPTNO;

SELECT EMPNO, ENAME, DEPTNO, SAL
FROM EMP
WHERE SAL IN (
    SELECT MAX(SAL)
    FROM EMP
    GROUP BY DEPTNO
);

SELECT e.*
FROM EMP e, (
    SELECT GRADE, AVG(SAL) SAL_AVG
    FROM EMP, SALGRADE
    WHERE SAL BETWEEN LOSAL AND HISAL
    GROUP BY GRADE
) g
WHERE SAL < SAL_AVG AND GRADE = 2;

SELECT *
FROM EMP
WHERE SAL <= (
    SELECT AVG(SAL)
    FROM EMP
    JOIN SALGRADE
    ON SAL BETWEEN LOSAL AND HISAL
    WHERE GRADE = 2
);